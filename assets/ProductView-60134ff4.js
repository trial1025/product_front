import{_ as F,af as I,K as M,L as A,M as N,x as T,A as $,P as R,Q as U,c as a,S as s,ag as j,U as z,a2 as D,V as y,a5 as o,a1 as u,X as n,a6 as E,a7 as L,ab as O,a9 as V,Z as v,a8 as J,J as K,a3 as Q,a4 as X}from"./index-ca79e1a9.js";import{_ as Z}from"./user-a7f6648a.js";import{c as G,e as H,u as W,d as Y,V as ee}from"./index.esm-c1443932.js";import{V as te}from"./VContainer-48439a55.js";import{V as b}from"./VRow-7f0ebc87.js";import{V as d}from"./VCol-48ed8392.js";import{V as ae}from"./VDivider-f57fd27d.js";const m=i=>(Q("data-v-fd194d42"),i=i(),X(),i),se={style:{"font-size":"larger"}},oe=m(()=>o("h3",null,"商品狀況",-1)),le=m(()=>o("h3",null,"商品描述",-1)),re={style:{"white-space":"pre"}},ue=m(()=>o("h4",null,"商品類別",-1)),ne=["loading"],ce=m(()=>o("h1",{class:"text-red text-h1"},"已下架",-1)),ie={__name:"ProductView",setup(i){const x=I(),p=M(),{api:w,apiAuth:S}=D(),_=A(),h=N(),e=T({_id:"",account:"",name:"",price:0,description:"",condition:"",image:"",sell:!0,category:""}),q=()=>{p.push("/orderreq")},C=G({quantity:H().typeError("缺少數量").required("缺少數量").min(1,"數量最小為 1")}),{isSubmitting:g,handleSubmit:k}=W({validationSchema:C,initialValues:{quantity:1}}),f=Y("quantity"),B=k(async c=>{var l,t;if(!h.isLogin){p.push("/login");return}try{const{data:r}=await S.patch("/users/cart",{product:e.value._id,quantity:c.quantity});h.cart=r.result,_({text:"新增成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}})}catch(r){const P=((t=(l=r==null?void 0:r.response)==null?void 0:l.data)==null?void 0:t.message)||"發生錯誤，請稍後再試";_({text:P,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}});return $(async()=>{var c,l;try{const{data:t}=await w.get("/products/"+x.params.id);e.value._id=t.result._id,e.value.account=t.result.account,e.value.name=t.result.name,e.value.price=t.result.price,e.value.description=t.result.description,e.value.condition=t.result.condition,e.value.image=t.result.image,e.value.sell=t.result.sell,e.value.category=t.result.category,document.title=`購物網 | ${e.value.name}`}catch(t){const r=((l=(c=t==null?void 0:t.response)==null?void 0:c.data)==null?void 0:l.message)||"發生錯誤，請稍後再試";_({text:r,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}}),p.push("/")}}),(c,l)=>(R(),U(z,null,[a(te,{"d-flex":""},{default:s(()=>[a(b,{justify:"center"},{default:s(()=>[a(d,{md:"4"},{default:s(()=>[a(y,{src:e.value.image},null,8,["src"])]),_:1}),a(d,{md:"4"},{default:s(()=>[o("p",se,u(e.value.name),1),o("h2",null,"NT$"+u(e.value.price),1),a(ae,{class:"my-3"}),oe,o("p",null,u(e.value.condition),1),le,o("p",re,u(e.value.description),1),ue,o("p",null,u(e.value.category),1),a(ee,{disabled:n(g),onSubmit:E(n(B),["prevent"])},{default:s(()=>[a(L,{class:"my-3",type:"number",min:"0",modelValue:n(f).value.value,"onUpdate:modelValue":l[0]||(l[0]=t=>n(f).value.value=t),modelModifiers:{number:!0},"error-messages":n(f).errorMessage.value,variant:"outlined",label:"數量",required:"",density:"compact"},null,8,["modelValue","error-messages"]),o("button",{class:"btn-red",type:"submit",loading:n(g),onClick:q},"購買",8,ne)]),_:1},8,["disabled","onSubmit"]),a(O,{class:"mt-8"},{default:s(()=>[a(V,null,{default:s(()=>[v("賣家資訊")]),_:1}),a(b,null,{default:s(()=>[a(d,{cols:"2"},{default:s(()=>[a(J,{class:"mb-2 ml-3",size:"30"},{default:s(()=>[a(y,{src:Z})]),_:1})]),_:1}),a(d,{cols:"10"},{default:s(()=>[a(V,{class:"py-1 m-0"},{default:s(()=>[v("@"+u(e.value.account),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(j,{class:"align-center justify-center text-center","model-value":!e.value.sell,persistent:""},{default:s(()=>[ce,a(K,{to:"/",color:"green"},{default:s(()=>[v("回首頁")]),_:1})]),_:1},8,["model-value"])],64))}},ge=F(ie,[["__scopeId","data-v-fd194d42"]]);export{ge as default};
