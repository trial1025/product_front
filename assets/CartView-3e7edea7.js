import{_ as y}from"./user-a7f6648a.js";import{M as g,N as k,L as C,x as v,A as b,P as w,Q as d,S as h,T as e,a6 as B,c as t,R,X as A,W as N,a5 as P,ao as L,at as S,V,au as i,$ as u,a1 as p,ax as T,J as I,Z as $}from"./index-197d9177.js";import{V as D,a as r}from"./VCol-51a39ae5.js";import{V as M}from"./VDivider-bb5790d4.js";import{V as f}from"./VRow-6f4481b0.js";const j=P("h2",null,"追蹤清單",-1),W={__name:"CartView",setup(z){const{apiAuth:_}=B(),c=g();k(),C();const n=v([]),x=async s=>{var l,o;try{await _.delete("/users/favorite/"+s),c({text:"刪除成功",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"green",location:"bottom"}}),n.value=n.value.filter(a=>a._id!==s)}catch(a){if(a.response&&a.response.status===404)c({text:"產品找不到，可能已被刪除",showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}});else{const m=((o=(l=a==null?void 0:a.response)==null?void 0:l.data)==null?void 0:o.message)||"發生錯誤，請稍後再試";c({text:m,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}};return b(async()=>{var s,l;try{const{data:o}=await _.get("/users/favorite");n.value.push(...o.result)}catch(o){console.log(o);const a=((l=(s=o==null?void 0:o.response)==null?void 0:s.data)==null?void 0:l.message)||"發生錯誤，請稍後再試";c({text:a,showCloseButton:!1,snackbarProps:{timeout:2e3,color:"red",location:"bottom"}})}}),(s,l)=>{const o=w("RouterLink");return d(),h(D,{"d-flex":"",style:{}},{default:e(()=>[t(f,{justify:"center",align:"center"},{default:e(()=>[t(r,{cols:"10"},{default:e(()=>[j]),_:1}),t(M),t(r,{cols:"10"},{default:e(()=>[t(f,null,{default:e(()=>[(d(!0),R(N,null,A(n.value,a=>(d(),h(r,{key:a._id},{default:e(()=>[t(L,{height:"360px",width:"200px",elevation:""},{default:e(()=>[t(o,{class:"text-decoration-none",to:"/products/"+a.product._id,style:{color:"black"}},{default:e(()=>[t(f,null,{default:e(()=>[t(r,{cols:"2"},{default:e(()=>[t(S,{class:"my-2",size:"30",style:{"margin-left":"10px"}},{default:e(()=>[t(V,{src:y})]),_:1})]),_:1}),t(r,null,{default:e(()=>[t(i,{class:"py-2"},{default:e(()=>[u("@"+p(a.product.account),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),t(V,{src:a.product.image,cover:"",style:{width:"90%",height:"200px",margin:"auto",borderRadius:"10px"}},null,8,["src"]),t(i,{class:"py-0"},{default:e(()=>[u(p(a.product.name),1)]),_:2},1024),t(i,{class:"py-0",style:{"font-weight":"bold"}},{default:e(()=>[u("NT$"+p(a.product.price),1)]),_:2},1024)]),_:2},1032,["to"]),t(T,{class:"py-0"},{default:e(()=>[t(I,{color:"red",icon:"",onClick:m=>x(a._id)},{default:e(()=>[t($,null,{default:e(()=>[u("mdi-heart")]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1})}}};export{W as default};
